<?xml version="1.0" encoding="UTF-8" ?>
<schema name="ncbo_lexical_entry" version="1.7">
  <field name="id" type="string" indexed="true" stored="true" required="true" multiValued="false" />
  <field name="_version_" type="long" indexed="false" stored="false"/>
  <field name="_root_" type="string" indexed="true" stored="false" docValues="false" />
  <field name="_text_" type="text_general" indexed="true" stored="false" multiValued="true"/>

  <!-- Core identity fields aligned with term_search -->
  <field name="resource_id" type="string" indexed="true" stored="true" multiValued="false" required="true" />
  <field name="ontologyId" type="string" indexed="true" stored="true" multiValued="false" />
  <field name="submissionAcronym" type="string" indexed="true" stored="true" multiValued="false" />
  <field name="submissionId" type="int" indexed="true" stored="true" multiValued="false" />

  <!-- Searchable fields for OntoLex -->
  <!-- lemma and forms.writtenRep act similar to prefLabel/synonym -->
  <field name="lemma" type="text_general" indexed="true" stored="true" multiValued="true" />
  <field name="lemmaExact" type="string_ci" indexed="true" stored="true" multiValued="true" />
  <field name="lemmaSuggest" type="text_suggest" indexed="true" stored="true" multiValued="true" omitNorms="true" />
  <field name="lemmaSuggestEdge" type="text_suggest_edge" indexed="true" stored="true" multiValued="true" />
  <field name="lemmaSuggestNgram" type="text_suggest_ngram" indexed="true" stored="true" multiValued="true" omitNorms="true" />

  <dynamicField name="lemma_*" type="text_general" indexed="true" stored="true" multiValued="true" />
  <dynamicField name="lemmaExact_*" type="string_ci" indexed="true" stored="true" multiValued="true" />
  <dynamicField name="lemmaSuggest_*" type="text_suggest" indexed="true" stored="true" omitNorms="true" multiValued="true" />
  <dynamicField name="lemmaSuggestEdge_*" type="text_suggest_edge" indexed="true" stored="true" multiValued="true" />
  <dynamicField name="lemmaSuggestNgram_*" type="text_suggest_ngram" indexed="true" stored="true" omitNorms="true" multiValued="true" />

  <field name="writtenRep" type="text_general" indexed="true" stored="true" multiValued="true" />
  <field name="writtenRepExact" type="string_ci" indexed="true" stored="true" multiValued="true" />
  <field name="writtenRepSuggest" type="text_suggest" indexed="true" stored="true" multiValued="true" omitNorms="true" />
  <field name="writtenRepSuggestEdge" type="text_suggest_edge" indexed="true" stored="true" multiValued="true" />
  <field name="writtenRepSuggestNgram" type="text_suggest_ngram" indexed="true" stored="true" multiValued="true" omitNorms="true" />

  <dynamicField name="writtenRep_*" type="text_general" indexed="true" stored="true" multiValued="true" />
  <dynamicField name="writtenRepExact_*" type="string_ci" indexed="true" stored="true" multiValued="true" />
  <dynamicField name="writtenRepSuggest_*" type="text_suggest" indexed="true" stored="true" omitNorms="true" multiValued="true" />
  <dynamicField name="writtenRepSuggestEdge_*" type="text_suggest_edge" indexed="true" stored="true" multiValued="true" />
  <dynamicField name="writtenRepSuggestNgram_*" type="text_suggest_ngram" indexed="true" stored="true" omitNorms="true" multiValued="true" />

  <!-- language, pos, entryType -->
  <field name="language" type="string_ci" indexed="true" stored="true" multiValued="true" />
  <field name="partOfSpeech" type="string_ci" indexed="true" stored="true" multiValued="true" />
  <field name="entryType" type="string_ci" indexed="true" stored="true" multiValued="true" />

  <!-- sense fields -->
  <field name="definition" type="string" indexed="true" stored="true" multiValued="true" />
  <dynamicField name="definition_*" type="string" indexed="true" stored="true" multiValued="true" />
  <field name="example" type="string" indexed="true" stored="true" multiValued="true" />

  <!-- concept fields -->
  <field name="concept" type="string" indexed="true" stored="true" multiValued="true" />
  <field name="conceptLabel" type="text_general" indexed="true" stored="true" multiValued="true" />

  <!-- raw properties if needed -->
  <field name="property" type="text_general" indexed="true" stored="true" multiValued="true" />
  <field name="propertyRaw" type="text_general" indexed="false" stored="true" multiValued="false" />

  <!-- copy rules like term_search -->
  <copyField source="lemma" dest="_text_"/>
  <copyField source="lemma" dest="lemmaExact"/>
  <copyField source="lemma" dest="lemmaSuggest" />
  <copyField source="lemma" dest="lemmaSuggestEdge" />
  <copyField source="lemma" dest="lemmaSuggestNgram" />

  <copyField source="writtenRep" dest="_text_"/>
  <copyField source="writtenRep" dest="writtenRepExact"/>
  <copyField source="writtenRep" dest="writtenRepSuggest" />
  <copyField source="writtenRep" dest="writtenRepSuggestEdge" />
  <copyField source="writtenRep" dest="writtenRepSuggestNgram" />

  <uniqueKey>id</uniqueKey>

  <!-- fieldTypes copied from term_search schema to keep behavior consistent -->
  <fieldType name="string" class="solr.StrField" sortMissingLast="true" docValues="true" />
  <fieldType name="string_ci" class="solr.TextField" omitNorms="true">
    <analyzer type="index">
      <tokenizer class="solr.KeywordTokenizerFactory"/>
      <filter class="solr.LowerCaseFilterFactory"/>
    </analyzer>
    <analyzer type="query">
      <tokenizer class="solr.KeywordTokenizerFactory"/>
      <filter class="solr.LowerCaseFilterFactory"/>
    </analyzer>
  </fieldType>
  <fieldType name="text_general" class="solr.TextField" positionIncrementGap="100">
    <analyzer type="index">
      <tokenizer class="solr.StandardTokenizerFactory"/>
      <filter class="solr.LowerCaseFilterFactory"/>
    </analyzer>
    <analyzer type="query">
      <tokenizer class="solr.StandardTokenizerFactory"/>
      <filter class="solr.LowerCaseFilterFactory"/>
    </analyzer>
  </fieldType>
  <fieldType name="text_suggest" class="solr.TextField" omitNorms="true">
    <analyzer type="index">
      <tokenizer class="solr.StandardTokenizerFactory"/>
      <filter class="solr.LowerCaseFilterFactory"/>
      <filter class="solr.ShingleFilterFactory" minShingleSize="2" maxShingleSize="5" outputUnigrams="true"/>
    </analyzer>
    <analyzer type="query">
      <tokenizer class="solr.StandardTokenizerFactory"/>
      <filter class="solr.LowerCaseFilterFactory"/>
    </analyzer>
  </fieldType>
  <fieldType name="text_suggest_edge" class="solr.TextField" omitNorms="true">
    <analyzer type="index">
      <tokenizer class="solr.StandardTokenizerFactory"/>
      <filter class="solr.LowerCaseFilterFactory"/>
      <filter class="solr.EdgeNGramFilterFactory" minGramSize="1" maxGramSize="20"/>
    </analyzer>
    <analyzer type="query">
      <tokenizer class="solr.StandardTokenizerFactory"/>
      <filter class="solr.LowerCaseFilterFactory"/>
    </analyzer>
  </fieldType>
  <fieldType name="text_suggest_ngram" class="solr.TextField" omitNorms="true">
    <analyzer type="index">
      <tokenizer class="solr.StandardTokenizerFactory"/>
      <filter class="solr.LowerCaseFilterFactory"/>
      <filter class="solr.NGramFilterFactory" minGramSize="2" maxGramSize="10"/>
    </analyzer>
    <analyzer type="query">
      <tokenizer class="solr.StandardTokenizerFactory"/>
      <filter class="solr.LowerCaseFilterFactory"/>
    </analyzer>
  </fieldType>
  <fieldType name="long" class="solr.TrieLongField" docValues="true" precisionStep="0" positionIncrementGap="0"/>
  <fieldType name="int" class="solr.TrieIntField" docValues="true" precisionStep="0" positionIncrementGap="0"/>
</schema>
